<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>表格输入页面</title>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>

<div id="app">
    <el-container>
        <el-header>
            <h2>表格输入</h2>
        </el-header>
        <el-main>
            <el-form ref="form" :model="form" label-width="120px">
                <el-form-item label="测站名称">
                    <el-input v-model="form.name"></el-input>
                </el-form-item>
                <el-form-item label="测站编码">
                    <el-input v-model="form.code" disabled></el-input>
                </el-form-item>
                <el-form-item label="站址">
                    <el-input v-model="form.address"></el-input>
                </el-form-item>
                <el-form-item label="开始时间">
                    <el-input v-model="form.startTime"></el-input>
                </el-form-item>
                <el-form-item label="结束时间">
                    <el-input v-model="form.endTime"></el-input>
                </el-form-item>
                <el-form-item label="河流编码">
                    <el-input v-model="form.waterName"></el-input>
                </el-form-item>
                <el-form-item label="测站类型">
                    <el-input v-model="form.type"></el-input>
                </el-form-item>
                <el-form-item label="东经">
                    <el-input v-model="form.e"></el-input>
                </el-form-item>
                <el-form-item label="北纬">
                    <el-input v-model="form.w"></el-input>
                </el-form-item>
                <el-form-item>
                    <el-button type="primary" @click="submitForm">提交</el-button>
                </el-form-item>
            </el-form>
        </el-main>
    </el-container>
</div>

<script>
    new Vue({
        el: '#app',
        data() {
            return {
                form: {
                    name: '',
                    code: '',
                    address: '',
                    startTime: '',
                    endTime: '',
                    waterName: '',
                    type: '',
                    e: '',
                    w: ''
                }
            };
        },
        created() {
            // 获取URL参数的函数
            function getUrlParameter(name) {
                name = name.replace(/[[]/, '\\[').replace(/[\]]/, '\\]');
                const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
                const results = regex.exec(location.search);
                return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
            }

            // 在页面加载时获取传递的数据
            this.form = {
                name: getUrlParameter('name'),
                code: getUrlParameter('code'),
                address: getUrlParameter('address'),
                startTime: getUrlParameter('startTime'),
                endTime: getUrlParameter('endTime'),
                waterName: getUrlParameter('waterName'),
                type: getUrlParameter('type'),
                e: getUrlParameter('e'),
                w: getUrlParameter('w'),
            };
        },
        methods: {
            submitForm() {
                axios.post('http://localhost:8080/CZ', this.form, {
                    headers: {
                        'Content-Type': 'application/json',
                    }
                })
                    .then(response => {
                        if (response.status === 200) {
                            window.location.href = '1.html';
                        } else {
                            this.$message.error('提交失败');
                        }
                    })
                    .catch(error => {
                        console.error('Error submitting form:', error);
                        this.$message.error('提交失败');
                    });
            }
        }
    });
</script>

</body>
</html>
