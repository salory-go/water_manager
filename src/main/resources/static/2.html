<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æµ‹ç«™ç®¡ç†</title>
  <link rel="stylesheet" href="./css/title.css">
  <link rel="stylesheet" href="./layui-v2.9.3/layui/css/layui.css">
  <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      text-align: center;
    }
  </style>
</head>
<body>
<div id="app">
  <el-menu class="el-menu-demo" mode="horizontal" class="flex">
    <el-menu-item index="1"><a href="1.html">æµ‹ç«™åŸºæœ¬ä¿¡æ¯è¡¨</a></el-menu-item>
    <el-menu-item index="2"><a href="2.html">æ²³æµåŸºæœ¬ä¿¡æ¯è¡¨</a></el-menu-item>
    <el-menu-item index="3"><a href="3.html">æµ‹ç«™è¯¦ç»†ä¿¡æ¯è¡¨</a></el-menu-item>
  </el-menu>
  <div id="clipped-title1">
      <h1>æµ‹ç«™ç®¡ç†</h1>
  </div>
  <div id="clipped-title3">
      <h1>æ²³æµåŸºæœ¬ä¿¡æ¯</h1>
  </div>

  <div style="text-align: right; margin-bottom: 10px;margin-right: 10px">
    <el-button type="primary" icon="el-icon-plus" circle @click="addRow"></el-button>
  </div>

  <el-table :data="tableData" style="width: 100%" stripe border>
    <el-table-column prop="hname" label="æ²³æµåç§°" fixed></el-table-column>
    <el-table-column prop="code" label="æ²³æµç¼–ç "></el-table-column>
    <el-table-column prop="lname" label="æµåŸŸåç§°"></el-table-column>
    <el-table-column prop="czname" label="æµ‹ç«™åç§°"></el-table-column>
    <el-table-column prop="name" label="æ°´ç³»åç§°"></el-table-column>
    <el-table-column label="æ“ä½œ">
      <template slot-scope="scope" width="120">
        <el-button size="mini" type="danger" icon="el-icon-delete" circle
                   @click="deleteRow(scope.row)"></el-button>
        <el-button size="mini" type="primary" icon="el-icon-edit" circle
                   @click="updateRow(scope.row)"></el-button>
      </template>
    </el-table-column>
  </el-table>
</div>

<script src="js/vue.js"></script>
<script src="./js/element.js"></script>
<script>
  new Vue({
    el: "#app",
    data() {
      return {
        currentTime: '',
        tableData: [],
        activeIndex: 1
      };
    },
    methods: {
      addRow() {
        window.location.href = 'add.html';
      },
      deleteRow(row) {
        this.$confirm('æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤è¯¥æµ‹ç«™ä¿¡æ¯, æ˜¯å¦ç»§ç»­?', 'æç¤º', {
          confirmButtonText: 'ç¡®å®š',
          cancelButtonText: 'å–æ¶ˆ',
          type: 'warning'
        }).then(() => {
          fetch(`http://localhost:8080/CZ/${row.stcd}`, {
            method: 'DELETE'
          }).then(() => {
            this.fetchData();
            this.$message({
              type: 'success',
              message: 'åˆ é™¤æˆåŠŸ!'
            });
          });
        }).catch(() => {
          // this.$message({
          //     type: 'info',
          //     message: 'å·²å–æ¶ˆ'
          // });
        });
      },
      updateRow(row) {
        const params = new URLSearchParams(row).toString();
        console.log(params);
        this.$message.error('æ²¡å†™æğŸ¤¯');
        // window.location.href = `update_1.html?${params}`;
      },
      fetchData() {
        fetch('http://localhost:8080/HL')
                .then(response => response.json())
                .then(data => {
                  this.tableData = data;
                  console.log(data);
                })
                .catch(error => console.error('Error fetching data:', error));
      },
      getCurrentTime() {
        const now = new Date();
        const hours = now.getHours().toString().padStart(2, '0');
        const minutes = now.getMinutes().toString().padStart(2, '0');
        const seconds = now.getSeconds().toString().padStart(2, '0');
        return `${hours}:${minutes}:${seconds}`;
      },
      updateCurrentTime() {
        this.currentTime = this.getCurrentTime();
      }
    },
    mounted() {
      this.fetchData();
      this.updateCurrentTime();
      this.activeIndex = 1;
    }
  });
</script>

</body>
</html>