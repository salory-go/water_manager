<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Demo</title>
    <link rel="stylesheet" href="./layui-v2.9.3/layui/css/layui.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
<style>
    .demo-login-container {
        width: 320px;
        margin: 21px auto 0;
    }

    .demo-login-other .layui-icon {
        position: relative;
        display: inline-block;
        margin: 0 2px;
        top: 2px;
        font-size: 26px;
    }
</style>

<div id="app" class="demo-login-container">
    <form @submit.prevent="login">
        <div class="layui-form-item">
            <div class="layui-input-wrap">
                <div class="layui-input-prefix">
                    <i class="layui-icon layui-icon-username"></i>
                </div>
                <input type="text" v-model="username" placeholder="用户名" autocomplete="off" class="layui-input"
                       required>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-input-wrap">
                <div class="layui-input-prefix">
                    <i class="layui-icon layui-icon-password"></i>
                </div>
                <input type="password" v-model="password" placeholder="密   码" autocomplete="off" class="layui-input"
                       required>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-row">
                <div class="layui-col-xs7">
                    <div class="layui-input-wrap"></div>
                </div>
            </div>
        </div>
        <div class="layui-form-item">
            <input type="checkbox" v-model="remember" lay-skin="primary" title="记住密码">
            <a href="#forget" style="float: right; margin-top: 7px;">忘记密码？</a>
        </div>
        <div class="layui-form-item">
            <button class="layui-btn layui-btn-fluid" type="submit">登录</button>
        </div>
        <div class="layui-form-item demo-login-other">
            <label>社交账号登录</label>
            <span style="padding: 0 21px 0 6px;">
        <a href="javascript:;"><i class="layui-icon layui-icon-login-qq" style="color: #3492ed;"></i></a>
        <a href="javascript:;"><i class="layui-icon layui-icon-login-wechat" style="color: #4daf29;"></i></a>
        <a href="javascript:;"><i class="layui-icon layui-icon-login-weibo" style="color: #cf1900;"></i></a>
      </span>
            或 <a href="#reg">注册帐号</a>
        </div>
    </form>
</div>

<script src="./layui-v2.9.3/layui/layui.js"></script>
<script src="custom-ajax-interceptor.js"></script>
<script>
    new Vue({
        el: '#app',
        data: {
            username: '',
            password: '',
            remember: false
        },
        methods: {
            login() {
                axios.post('http://localhost:8080/login', {
                    username: this.username,
                    password: this.password
                }, {
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                    .then(response => {
                        // console.log(response.data);
                        if (response.data.code === 0) {
                            location.href = "http://localhost:8080/1.html";
                            localStorage.setItem("token", response.data.data);
                            access_token=response.data.data;
                            document.cookie = access_token;
                        } else {
                            // 处理错误情况
                            layer.msg('用户名或密码错误', {icon: 0}, function(){
                                // layer.msg('提示框关闭后的回调');
                            });
                        }
                    })
                    .catch(error => {
                        console.error(error);
                    });
            }
        }
    });
</script>

</body>
</html>
